# IncSpec Roadmap

> 面向 AI 编程助手的增量规范驱动开发工具的演进路线图

## 关联文档（P0，跨阶段）
- 兼容性策略（兼容契约/破坏性变更判定/弃用与迁移）：`roadmap/compatibility-policy.md`
- 发版门禁（Execution/Verification/Observability/Coordination）：`roadmap/release-gate.md`
- 模板同步策略（含模板一致性统一规范）：`roadmap/template-sync-strategy.md`

---

## 核心定位与差异化价值

### IncSpec 是什么？

IncSpec 是一个**基线优先的增量规范驱动开发工具**，专为复杂 brownfield 项目设计。与"规范驱动"（Spec-Driven）工具不同，IncSpec 首先帮助 AI 编程助手**理解现有代码**，再定义增量变更。

### 为什么选择 IncSpec？

| 痛点 | 传统规范驱动 | IncSpec 增量规范驱动 |
|------|-------------|-------------------|
| AI 不理解现有代码上下文 | 用户手动描述 | **自动捕获代码基线** |
| 变更破坏现有功能 | 事后发现 | **变更前风险评估** |
| 依赖关系不清晰 | 人工追踪 | **6 维度依赖追踪** |
| 增量变更难以管理 | 全量重写 | **基于基线的增量设计** |
| 历史变更不可追溯 | 依赖 Git 记录 | **规范化归档与版本管理** |

### 核心差异化

1. **基线优先**：在变更前先捕获和理解现有代码流程，为 AI 提供精准上下文
2. **增量精准**：基于基线的差异分析，精确定位变更影响范围
3. **历史可追溯**：每轮产出成为下一轮基线，形成完整的演进记录
4. **规范生成而非执行**：专注于生成规范文档供 AI 参考，不执行用户代码

---

## 工作流模式

IncSpec 提供三种工作流模式，适应不同复杂度的开发场景：

### 极简模式（Minimal）- 3 步

对标 OpenSpec 的轻量级工作流，适合简单变更和快速迭代：

```bash
incspec analyze <source> --minimal   # 步骤 1: 快速分析
incspec apply                        # 步骤 2: 应用变更
incspec archive -y                   # 步骤 3: 归档
```

**适用场景**：Bug 修复、小型功能调整、紧急修复

### 快速模式（Quick）- 5 步

跳过 UI 依赖采集和增量设计，适合中等复杂度变更：

```bash
incspec analyze <source> --quick     # 步骤 1: 代码分析
incspec collect-req                  # 步骤 2: 需求收集
incspec apply                        # 步骤 5: 应用变更
incspec merge                        # 步骤 6: 合并基线
incspec archive -y                   # 步骤 7: 归档
```

**适用场景**：中型功能开发、需求明确的变更

### 完整模式（Full）- 7 步

完整的增量规范驱动开发流程，适合复杂功能开发：

```bash
incspec analyze <source>             # 步骤 1: 代码流程分析
incspec collect-req                  # 步骤 2: 结构化需求收集
incspec collect-dep                  # 步骤 3: UI 依赖采集
incspec design --feature=xxx         # 步骤 4: 增量设计
incspec apply                        # 步骤 5: 应用代码变更
incspec merge                        # 步骤 6: 合并到基线
incspec archive -y                   # 步骤 7: 归档产出
```

**适用场景**：大型功能开发、复杂重构、跨模块变更

---

## 重要：向后兼容与发版门禁（P0，跨阶段约束）

> 兼容窗口：**从当前版本起一直到 v1.0.0 正式版发布**。在此窗口内，IncSpec 必须兼容当前的「增量规范驱动开发」工作流与 CLI 使用方式，并确保模板同步策略随版本发布一起完成。

### 1) 向后兼容契约（Compatibility Contract）

在 v1.0.0 之前，以下对象默认视为 **兼容契约**（除非明确标注弃用与迁移）：

- **CLI 命令与参数**
  - 命令名 / 别名保持可用
  - 参数名与语义保持稳定；如需新增行为优先通过新增参数实现，避免改变默认语义
  - 输出格式：面向人类的文本输出允许增强，但需要保持核心信息可读且不破坏既有使用习惯

- **工作流状态机**
  - 7 步工作流及 MINIMAL/QUICK/FULL 的语义保持稳定
  - `WORKFLOW.md` 的关键字段、状态枚举与推进规则保持兼容（必要变更必须提供迁移）

- **规范文件与目录结构**
  - `incspec/` 目录结构、spec 文件命名与归档规则保持兼容
  - 任何会影响脚本或工具解析的变更必须视为兼容性风险，需按弃用流程推进

- **AI 工具协同模板**
  - `templates/` 的核心入口文件（例如 `AGENTS.md`、Claude Skill 入口 `SKILL.md`）必须与 CLI 同步发布
  - 若 CLI 新增/调整命令或参数，必须同步更新模板并通过校验

### 2) 弃用（Deprecation）与迁移策略

- **原则**：尽量"新增不破坏"；必要变更采用"弃用 → 迁移 → 移除（v1.0 后）"
- **流程（建议）**：
  1. `warn`：提示弃用信息 + 替代用法 + 文档链接
  2. `soft`：默认仍兼容旧用法，但模板/文档切到新用法
  3. `remove@v1.0+`：1.0 后才允许移除旧用法（或在 1.0 中保留兼容层）

### 3) 发版门禁（Release Gate）

每个版本发布前必须满足（最小集合）：

- **可执行（Execution）**
  - 所有新增命令具备 `--help` 示例与最小可用说明
  - 重要行为变更具备升级提示与迁移指南（可简单）

- **可验证（Verification）**
  - 模板同步校验通过（CLI ↔ templates 一致性）
  - 基础回归用例通过（至少覆盖核心工作流：analyze → collect-req → apply → merge → archive 的主路径）

- **可监控（Observability）**
  - 至少具备本地可观测数据：命令耗时、成功/失败、错误码、关键步骤推进事件（用于验证"错误率/延迟/成功率"等指标）

- **可协调（Coordination）**
  - 变更日志（CHANGELOG/Release Notes）包含：新增、修复、弃用、迁移提示
  - 版本号与文档/模板同步更新（不可选）

---

## 发展目标

下一阶段的核心目标是将 IncSpec 从"工作流脚手架"升级为"智能开发伙伴"：

### 1. 强化核心差异化能力（优先）
- 基线差异智能分析
- 破坏性变更检测与风险评估
- 增量基线版本管理

### 2. 扩展 AI 工具生态（优先）
- 快速支持主流 AI 编程助手（5+ 工具）
- 利用 AGENTS.md 标准扩展兼容性
- 统一的 AI 工具接口层

### 3. 提升人机交互体验
- 极简模式降低入门门槛
- 智能化命令建议和错误恢复
- 可视化工作流进度

### 4. 完善工作流协作
- 团队协作和版本冲突处理
- 持续集成和自动化部署支持
- 工作流智能推荐

### 5. 生态系统建设
- 插件系统和社区贡献
- 性能优化和可观测性增强

---

## 重要：CLI 与 AI 工具协同

IncSpec 是一个 CLI 工具，但它与 AI 编程助手（Cursor、Claude Code、GitHub Copilot 等）紧密协同工作。**每个阶段的功能开发必须同步更新 `templates/` 目录下的指令模板**，确保 AI 工具能够正确使用新功能。

详细的模板同步策略请参考：[模板同步策略文档](./template-sync-strategy.md)

**关键原则**:
- CLI 功能开发 = CLI 代码 + 对应的 AI 工具模板
- 模板更新与 CLI 发布同步，不是可选项
- 每个 PR 必须包含相关的模板更新
- 任何 CLI 的新增/调整，必须通过"模板一致性校验"（见上方 Release Gate）

---

## 实施阶段

> **调整说明**：基于竞争分析，将 AI 工具生态和核心差异化能力提升优先级，与交互体验增强并行推进。

### [阶段 1A: 核心差异化与极简模式](./phase1a-core-differentiation.md) (v0.3.x)

**时间跨度**: 1.5-2 个月

**核心目标**: 强化核心差异化能力，引入极简模式降低入门门槛

**关键成果**:
- 极简模式（3 步工作流）
- 基线差异分析基础能力（从阶段 2 前移）
- 破坏性变更检测（从阶段 2 前移）

**详细计划**: [phase1a-core-differentiation.md](./phase1a-core-differentiation.md)

---

### [阶段 1B: AI 工具生态扩展](./phase1b-ai-ecosystem.md) (v0.3.x - v0.4.x)

**时间跨度**: 1.5-2 个月（与阶段 1A 并行）

**核心目标**: 快速扩展 AI 工具支持，建立生态基础

**关键成果**:
- 支持 5+ 主流 AI 工具（GitHub Copilot、Windsurf、Gemini CLI 等）
- 统一 AI 适配层接口
- AGENTS.md 标准兼容

**详细计划**: [phase1b-ai-ecosystem.md](./phase1b-ai-ecosystem.md)

---

### [阶段 2: 交互体验增强](./phase2-interaction.md) (v0.4.x - v0.5.x)

**时间跨度**: 2-3 个月

**核心目标**: 显著提升命令行交互体验，降低学习成本

**关键成果**:
- 交互式工作流向导
- 智能命令建议和错误恢复
- 工作流可视化和进度仪表盘
- 多语言国际化支持

**详细计划**: [phase2-interaction.md](./phase2-interaction.md)

---

### [阶段 3: 代码生成增强](./phase3-codegen.md) (v0.5.x - v0.6.x)

**时间跨度**: 2-3 个月

**核心目标**: 深化代码生成精准度和质量保障能力

**关键成果**:
- 自动化测试规范生成
- 代码质量规范定义
- 智能冲突分析与解决建议
- 增量基线版本管理增强

**详细计划**: [phase3-codegen.md](./phase3-codegen.md)

---

### [阶段 4: 工作流协调优化](./phase4-workflow.md) (v0.7.x - v0.8.x)

**时间跨度**: 3-4 个月

**核心目标**: 优化团队协作和工作流智能化

**关键成果**:
- 工作流智能推荐引擎
- 团队协作模式
- CI/CD 集成
- 性能优化

**详细计划**: [phase4-workflow.md](./phase4-workflow.md)

---

### [阶段 5: 生态系统建设](./phase5-ecosystem.md) (v0.9.x - v1.0.x)

**时间跨度**: 3-4 个月

**核心目标**: 构建可扩展的插件系统和社区生态

**关键成果**:
- 插件系统和 Registry
- 可观测性平台
- v1.0 正式版发布

**详细计划**: [phase5-ecosystem.md](./phase5-ecosystem.md)

---

## 版本规划

| 版本 | 阶段 | 关键特性 | 预计发布 |
|------|------|----------|----------|
| v0.3.0 | 阶段 1A | 极简模式、基线差异分析 | Q1 2025 |
| v0.3.5 | 阶段 1B | 5+ AI 工具支持、统一适配层 | Q1 2025 |
| v0.4.0 | 阶段 2 启动 | 交互式向导、智能建议 | Q2 2025 |
| v0.5.0 | 阶段 2 完成 | 可视化面板、国际化 | Q2 2025 |
| v0.6.0 | 阶段 3 完成 | 测试规范、质量规范、冲突解决 | Q3 2025 |
| v0.7.0 | 阶段 4 启动 | 智能推荐、团队协作 | Q3 2025 |
| v0.8.0 | 阶段 4 完成 | CI/CD 集成、性能优化 | Q4 2025 |
| v0.9.0 | 阶段 5 启动 | 插件系统 | Q4 2025 |
| v1.0.0 | 正式版 | 生态完善、文档齐全 | Q1 2026 |

---

## 关键指标

### 核心差异化指标（新增）
- 基线分析准确率: 90%+
- 破坏性变更检测率: 85%+
- AI 工具覆盖: v0.4.0 前达到 5+

### 用户体验指标
- 极简模式上手时间: 5 分钟内
- 完整模式上手时间: 从 30 分钟降至 15 分钟
- 命令错误率: 降低 60%
- 工作流完成率: 提升至 85%+

### 代码质量指标
- 生成代码测试覆盖率: 提升至 70%+
- 代码质量评分: 提升至 B 级以上
- 冲突解决成功率: 提升至 80%+

### 性能指标
- 工作流执行时间: 优化 40%
- 大型项目支持: 10,000+ 文件
- 内存占用: 降低 30%

### 生态指标
- 社区插件数量: 20+
- AI 工具适配: 10+（调整目标）
- GitHub Stars: 1000+
- 月活跃用户: 500+

---

## 竞争策略

### 与 OpenSpec 的关系

IncSpec 与 OpenSpec 是**互补而非竞争**关系：

| 场景 | 推荐工具 |
|------|----------|
| Greenfield（从零开始） | OpenSpec |
| 简单 Brownfield 变更 | OpenSpec 或 IncSpec 极简模式 |
| 复杂 Brownfield 项目 | **IncSpec**（核心优势） |
| 需要深度代码理解 | **IncSpec**（基线分析） |
| 需要变更风险评估 | **IncSpec**（破坏性变更检测） |
| 跨模块/大型重构 | **IncSpec**（完整模式） |

### 核心竞争优势

1. **基线分析能力**：AI 理解现有代码上下文，生成更精准的变更
2. **变更风险可控**：破坏性变更检测和回归风险评估
3. **历史可追溯**：规范化的增量归档和版本管理
4. **企业级功能**：团队协作、CI/CD 集成、可观测性

---

## 贡献方式

我们欢迎社区贡献！请参考 [CONTRIBUTING.md](../CONTRIBUTING.md) 了解如何参与：

- 提交 Issue 和功能建议
- 贡献代码和文档
- 开发插件和扩展
- 分享使用案例

## 反馈渠道

- GitHub Issues: [https://github.com/localSummer/IncSpec/issues](https://github.com/localSummer/IncSpec/issues)
- 讨论区: [GitHub Discussions](https://github.com/localSummer/IncSpec/discussions)
- Email: [项目邮箱]

---

**最后更新**: 2024-12-24
**版本**: Roadmap v2.0
